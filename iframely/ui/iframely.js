/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

eval("var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/**\n * Iramely oembed scripts\n */\nvar __ = wp.i18n.__;\nvar createHigherOrderComponent = wp.compose.createHigherOrderComponent;\nvar Fragment = wp.element.Fragment;\nvar InspectorControls = wp.blockEditor.InspectorControls;\n\nvar iEvent = new RegExp(\"setIframelyEmbedOptions\");\nvar PanelBody = wp.components.PanelBody;\n\n\nfunction findIframeByContentWindow(iframes, contentWindow) {\n    var foundIframe = void 0;\n    for (var i = 0; i < iframes.length && !foundIframe; i++) {\n        var iframe = iframes[i];\n        if (iframe.contentWindow === contentWindow) {\n            foundIframe = iframe;\n        }\n    }\n    return foundIframe;\n}\n\nfunction sortObject(obj) {\n    return Object.keys(obj).sort().reduce(function (acc, key) {\n        if (Array.isArray(obj[key])) {\n            acc[key] = obj[key].map(sortObject);\n        }\n        if (_typeof(obj[key]) === 'object') {\n            acc[key] = sortObject(obj[key]);\n        } else {\n            acc[key] = obj[key];\n        }\n        return acc;\n    }, {});\n}\n\nfunction getSelectedBlockID() {\n    return wp.data.select('core/editor').getBlockSelectionStart();\n}\n\nfunction addIframelyString(url, query) {\n    var newUrl = url.replace(/\\??&?iframely=(.+)$/, '');\n    newUrl += Object.keys(query).length === 0 ? '' : (/\\?/.test(newUrl) ? '&' : '?') + 'iframely=' + window.btoa(JSON.stringify(query));\n\n    return newUrl;\n}\n\nfunction updatePreview(query) {\n    // block options interaction\n    var blockAttrs = wp.data.select('core/block-editor').getBlockAttributes(getSelectedBlockID()),\n        url = blockAttrs.url;\n\n    var newUrl = addIframelyString(url, sortObject(query));\n\n    // bust the cache preview, so it re-renders when returning to previous options\n    // also warms up cache if URL is new, as the next time getEmbedPreview will return cached value\n    if (wp.data.select('core').getEmbedPreview(newUrl)) {\n        wp.data.dispatch('core/data').invalidateResolution('core', 'getEmbedPreview', [newUrl]);\n    }\n\n    // Update the corresponding block and get a preview if required\n    wp.data.dispatch('core/block-editor').updateBlockAttributes(getSelectedBlockID(), { url: newUrl });\n    console.log(\"Changed URL: \", newUrl);\n}\n\nif (iframely) {\n    // Failsafe in case of iframely name space not accessible.\n    // E.g. no internet connection\n    iframely.on('options-changed', function (id, formContainer, query) {\n        updatePreview(query);\n    });\n}\n\nwindow.addEventListener(\"message\", function (e) {\n    // Listen for messages from iframe proxy script\n    if (iEvent.test(e.data)) {\n        var frames = document.getElementsByTagName(\"iframe\"),\n            iframe = findIframeByContentWindow(frames, e.source);\n        var data = JSON.parse(e.data);\n        $(iframe).data(data);\n    }\n}, false);\n\nvar IframelyOptions = function (_React$Component) {\n    _inherits(IframelyOptions, _React$Component);\n\n    function IframelyOptions() {\n        _classCallCheck(this, IframelyOptions);\n\n        return _possibleConstructorReturn(this, (IframelyOptions.__proto__ || Object.getPrototypeOf(IframelyOptions)).apply(this, arguments));\n    }\n\n    _createClass(IframelyOptions, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            iframely.buildOptionsForm(this.props.selector, $('div#ifopts').get(0), this.props.options.data);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            return wp.element.createElement(\n                'div',\n                { id: 'ifopts',\n                    'data-id': this.props.clientId,\n                    'data-opts': JSON.stringify(this.props.options.data)\n                },\n                this.body\n            );\n        }\n    }]);\n\n    return IframelyOptions;\n}(React.Component);\n\nIframelyOptions.defaultProps = {\n    body: '',\n    clientId: '',\n    selector: '',\n    options: ''\n};\nvar withInspectorControls = createHigherOrderComponent(function (BlockEdit) {\n    return function (props) {\n        var fragment = wp.element.createElement(\n            Fragment,\n            null,\n            wp.element.createElement(BlockEdit, props)\n        );\n        if (props.isSelected === true && (props.name === \"core/embed\" || props.name.startsWith(\"core-embed\"))) {\n            var selector = 'div#block-' + props.clientId;\n            var options = $(selector).find('iframe').data();\n            if (!options || !options.data) {\n                return fragment;\n            }\n            return wp.element.createElement(\n                Fragment,\n                null,\n                wp.element.createElement(BlockEdit, props),\n                wp.element.createElement(\n                    InspectorControls,\n                    null,\n                    wp.element.createElement(\n                        PanelBody,\n                        { title: 'Iframely options' },\n                        wp.element.createElement(IframelyOptions, { selector: selector, options: options, clientId: props.clientId })\n                    )\n                )\n            );\n        } else {\n            return fragment;\n        }\n    };\n}, \"withInspectorControl\");\n\nwp.hooks.addFilter('editor.BlockEdit', 'iframely/with-inspector-controls', withInspectorControls);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanM/OTU1MiJdLCJuYW1lcyI6WyJfXyIsIndwIiwiaTE4biIsImNyZWF0ZUhpZ2hlck9yZGVyQ29tcG9uZW50IiwiY29tcG9zZSIsIkZyYWdtZW50IiwiZWxlbWVudCIsIkluc3BlY3RvckNvbnRyb2xzIiwiYmxvY2tFZGl0b3IiLCJpRXZlbnQiLCJSZWdFeHAiLCJQYW5lbEJvZHkiLCJjb21wb25lbnRzIiwiZmluZElmcmFtZUJ5Q29udGVudFdpbmRvdyIsImlmcmFtZXMiLCJjb250ZW50V2luZG93IiwiZm91bmRJZnJhbWUiLCJpIiwibGVuZ3RoIiwiaWZyYW1lIiwic29ydE9iamVjdCIsIm9iaiIsIk9iamVjdCIsImtleXMiLCJzb3J0IiwicmVkdWNlIiwiYWNjIiwia2V5IiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwiZ2V0U2VsZWN0ZWRCbG9ja0lEIiwiZGF0YSIsInNlbGVjdCIsImdldEJsb2NrU2VsZWN0aW9uU3RhcnQiLCJhZGRJZnJhbWVseVN0cmluZyIsInVybCIsInF1ZXJ5IiwibmV3VXJsIiwicmVwbGFjZSIsInRlc3QiLCJ3aW5kb3ciLCJidG9hIiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZVByZXZpZXciLCJibG9ja0F0dHJzIiwiZ2V0QmxvY2tBdHRyaWJ1dGVzIiwiZ2V0RW1iZWRQcmV2aWV3IiwiZGlzcGF0Y2giLCJpbnZhbGlkYXRlUmVzb2x1dGlvbiIsInVwZGF0ZUJsb2NrQXR0cmlidXRlcyIsImNvbnNvbGUiLCJsb2ciLCJpZnJhbWVseSIsIm9uIiwiaWQiLCJmb3JtQ29udGFpbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJmcmFtZXMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwic291cmNlIiwicGFyc2UiLCIkIiwiSWZyYW1lbHlPcHRpb25zIiwiYnVpbGRPcHRpb25zRm9ybSIsInByb3BzIiwic2VsZWN0b3IiLCJnZXQiLCJvcHRpb25zIiwiY2xpZW50SWQiLCJib2R5IiwiUmVhY3QiLCJDb21wb25lbnQiLCJkZWZhdWx0UHJvcHMiLCJ3aXRoSW5zcGVjdG9yQ29udHJvbHMiLCJCbG9ja0VkaXQiLCJmcmFnbWVudCIsImlzU2VsZWN0ZWQiLCJuYW1lIiwic3RhcnRzV2l0aCIsImZpbmQiLCJob29rcyIsImFkZEZpbHRlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7SUFHUUEsRSxHQUFPQyxHQUFHQyxJLENBQVZGLEU7SUFDQUcsMEIsR0FBK0JGLEdBQUdHLE8sQ0FBbENELDBCO0lBQ0FFLFEsR0FBYUosR0FBR0ssTyxDQUFoQkQsUTtJQUNBRSxpQixHQUFzQk4sR0FBR08sVyxDQUF6QkQsaUI7O0FBQ1IsSUFBTUUsU0FBUyxJQUFJQyxNQUFKLENBQVcseUJBQVgsQ0FBZjtJQUNRQyxTLEdBQWNWLEdBQUdXLFUsQ0FBakJELFM7OztBQUVSLFNBQVNFLHlCQUFULENBQW1DQyxPQUFuQyxFQUE0Q0MsYUFBNUMsRUFBMkQ7QUFDdkQsUUFBSUMsb0JBQUo7QUFDQSxTQUFJLElBQUlDLElBQUksQ0FBWixFQUFlQSxJQUFJSCxRQUFRSSxNQUFaLElBQXNCLENBQUNGLFdBQXRDLEVBQW1EQyxHQUFuRCxFQUF3RDtBQUNwRCxZQUFJRSxTQUFTTCxRQUFRRyxDQUFSLENBQWI7QUFDQSxZQUFJRSxPQUFPSixhQUFQLEtBQXlCQSxhQUE3QixFQUE0QztBQUN4Q0MsMEJBQWNHLE1BQWQ7QUFDSDtBQUNKO0FBQ0QsV0FBT0gsV0FBUDtBQUNIOztBQUVELFNBQVNJLFVBQVQsQ0FBb0JDLEdBQXBCLEVBQXdCO0FBQ3BCLFdBQU9DLE9BQU9DLElBQVAsQ0FBWUYsR0FBWixFQUFpQkcsSUFBakIsR0FBd0JDLE1BQXhCLENBQStCLFVBQUNDLEdBQUQsRUFBS0MsR0FBTCxFQUFXO0FBQzdDLFlBQUlDLE1BQU1DLE9BQU4sQ0FBY1IsSUFBSU0sR0FBSixDQUFkLENBQUosRUFBNEI7QUFDeEJELGdCQUFJQyxHQUFKLElBQVNOLElBQUlNLEdBQUosRUFBU0csR0FBVCxDQUFhVixVQUFiLENBQVQ7QUFDSDtBQUNELFlBQUksUUFBT0MsSUFBSU0sR0FBSixDQUFQLE1BQW9CLFFBQXhCLEVBQWlDO0FBQzdCRCxnQkFBSUMsR0FBSixJQUFTUCxXQUFXQyxJQUFJTSxHQUFKLENBQVgsQ0FBVDtBQUNILFNBRkQsTUFHSTtBQUNBRCxnQkFBSUMsR0FBSixJQUFTTixJQUFJTSxHQUFKLENBQVQ7QUFDSDtBQUNELGVBQU9ELEdBQVA7QUFDSCxLQVhNLEVBV0wsRUFYSyxDQUFQO0FBWUg7O0FBRUQsU0FBU0ssa0JBQVQsR0FBOEI7QUFDMUIsV0FBTzlCLEdBQUcrQixJQUFILENBQVFDLE1BQVIsQ0FBZ0IsYUFBaEIsRUFBZ0NDLHNCQUFoQyxFQUFQO0FBQ0g7O0FBRUQsU0FBU0MsaUJBQVQsQ0FBMkJDLEdBQTNCLEVBQWdDQyxLQUFoQyxFQUF1QztBQUNuQyxRQUFJQyxTQUFTRixJQUFJRyxPQUFKLENBQVkscUJBQVosRUFBbUMsRUFBbkMsQ0FBYjtBQUNBRCxjQUFVaEIsT0FBT0MsSUFBUCxDQUFZYyxLQUFaLEVBQW1CbkIsTUFBbkIsS0FBOEIsQ0FBOUIsR0FBa0MsRUFBbEMsR0FBd0MsQ0FBQyxLQUFLc0IsSUFBTCxDQUFVRixNQUFWLElBQW9CLEdBQXBCLEdBQXlCLEdBQTFCLElBQWlDLFdBQWpDLEdBQStDRyxPQUFPQyxJQUFQLENBQVlDLEtBQUtDLFNBQUwsQ0FBZVAsS0FBZixDQUFaLENBQWpHOztBQUVBLFdBQU9DLE1BQVA7QUFDSDs7QUFFRCxTQUFTTyxhQUFULENBQXVCUixLQUF2QixFQUE4QjtBQUMxQjtBQUNBLFFBQUlTLGFBQWE3QyxHQUFHK0IsSUFBSCxDQUFRQyxNQUFSLENBQWUsbUJBQWYsRUFBb0NjLGtCQUFwQyxDQUF1RGhCLG9CQUF2RCxDQUFqQjtBQUFBLFFBQ0lLLE1BQU1VLFdBQVdWLEdBRHJCOztBQUdBLFFBQUlFLFNBQVNILGtCQUFrQkMsR0FBbEIsRUFBdUJoQixXQUFXaUIsS0FBWCxDQUF2QixDQUFiOztBQUVBO0FBQ0E7QUFDQSxRQUFJcEMsR0FBRytCLElBQUgsQ0FBUUMsTUFBUixDQUFnQixNQUFoQixFQUF5QmUsZUFBekIsQ0FBeUNWLE1BQXpDLENBQUosRUFBc0Q7QUFDbERyQyxXQUFHK0IsSUFBSCxDQUFRaUIsUUFBUixDQUFpQixXQUFqQixFQUE4QkMsb0JBQTlCLENBQW9ELE1BQXBELEVBQTRELGlCQUE1RCxFQUErRSxDQUFFWixNQUFGLENBQS9FO0FBQ0g7O0FBRUQ7QUFDQXJDLE9BQUcrQixJQUFILENBQVFpQixRQUFSLENBQWlCLG1CQUFqQixFQUFzQ0UscUJBQXRDLENBQTREcEIsb0JBQTVELEVBQWtGLEVBQUVLLEtBQUtFLE1BQVAsRUFBbEY7QUFDQWMsWUFBUUMsR0FBUixDQUFZLGVBQVosRUFBNkJmLE1BQTdCO0FBQ0g7O0FBRUQsSUFBSWdCLFFBQUosRUFBYztBQUNWO0FBQ0E7QUFDQUEsYUFBU0MsRUFBVCxDQUFZLGlCQUFaLEVBQStCLFVBQVNDLEVBQVQsRUFBYUMsYUFBYixFQUE0QnBCLEtBQTVCLEVBQW1DO0FBQzlEUSxzQkFBY1IsS0FBZDtBQUNILEtBRkQ7QUFHSDs7QUFFREksT0FBT2lCLGdCQUFQLENBQXdCLFNBQXhCLEVBQWtDLFVBQVNDLENBQVQsRUFBVztBQUN6QztBQUNBLFFBQUdsRCxPQUFPK0IsSUFBUCxDQUFZbUIsRUFBRTNCLElBQWQsQ0FBSCxFQUF3QjtBQUNwQixZQUFJNEIsU0FBU0MsU0FBU0Msb0JBQVQsQ0FBOEIsUUFBOUIsQ0FBYjtBQUFBLFlBQ0kzQyxTQUFTTiwwQkFBMEIrQyxNQUExQixFQUFrQ0QsRUFBRUksTUFBcEMsQ0FEYjtBQUVBLFlBQUkvQixPQUFPVyxLQUFLcUIsS0FBTCxDQUFXTCxFQUFFM0IsSUFBYixDQUFYO0FBQ0FpQyxVQUFFOUMsTUFBRixFQUFVYSxJQUFWLENBQWVBLElBQWY7QUFDSDtBQUNKLENBUkQsRUFRRSxLQVJGOztJQVdNa0MsZTs7Ozs7Ozs7Ozs7NENBRWtCO0FBQ2hCWixxQkFBU2EsZ0JBQVQsQ0FBMEIsS0FBS0MsS0FBTCxDQUFXQyxRQUFyQyxFQUErQ0osRUFBRSxZQUFGLEVBQWdCSyxHQUFoQixDQUFvQixDQUFwQixDQUEvQyxFQUF1RSxLQUFLRixLQUFMLENBQVdHLE9BQVgsQ0FBbUJ2QyxJQUExRjtBQUNIOzs7aUNBRVE7QUFDTCxtQkFBTztBQUFBO0FBQUEsa0JBQUssSUFBRyxRQUFSO0FBQ0ssK0JBQVUsS0FBS29DLEtBQUwsQ0FBV0ksUUFEMUI7QUFFSyxpQ0FBVzdCLEtBQUtDLFNBQUwsQ0FBZSxLQUFLd0IsS0FBTCxDQUFXRyxPQUFYLENBQW1CdkMsSUFBbEM7QUFGaEI7QUFHSixxQkFBS3lDO0FBSEQsYUFBUDtBQUlIOzs7O0VBWHlCQyxNQUFNQyxTOztBQWNwQ1QsZ0JBQWdCVSxZQUFoQixHQUErQjtBQUMzQkgsVUFBTSxFQURxQjtBQUUzQkQsY0FBVSxFQUZpQjtBQUczQkgsY0FBVSxFQUhpQjtBQUkzQkUsYUFBUztBQUprQixDQUEvQjtBQU1BLElBQU1NLHdCQUF5QjFFLDJCQUE0QixVQUFFMkUsU0FBRixFQUFpQjtBQUN4RSxXQUFPLFVBQUVWLEtBQUYsRUFBYTtBQUNoQixZQUFJVyxXQUFZO0FBQUMsb0JBQUQ7QUFBQTtBQUFVLHFDQUFDLFNBQUQsRUFBZ0JYLEtBQWhCO0FBQVYsU0FBaEI7QUFDQSxZQUFJQSxNQUFNWSxVQUFOLEtBQW1CLElBQW5CLEtBQTRCWixNQUFNYSxJQUFOLEtBQWUsWUFBZixJQUErQmIsTUFBTWEsSUFBTixDQUFXQyxVQUFYLENBQXNCLFlBQXRCLENBQTNELENBQUosRUFBcUc7QUFDakcsZ0JBQUliLFdBQVcsZUFBZUQsTUFBTUksUUFBcEM7QUFDQSxnQkFBSUQsVUFBVU4sRUFBRUksUUFBRixFQUFZYyxJQUFaLENBQWlCLFFBQWpCLEVBQTJCbkQsSUFBM0IsRUFBZDtBQUNBLGdCQUFJLENBQUN1QyxPQUFELElBQVksQ0FBQ0EsUUFBUXZDLElBQXpCLEVBQStCO0FBQzNCLHVCQUFPK0MsUUFBUDtBQUNIO0FBQ0QsbUJBQ0k7QUFBQyx3QkFBRDtBQUFBO0FBQ0kseUNBQUMsU0FBRCxFQUFnQlgsS0FBaEIsQ0FESjtBQUVJO0FBQUMscUNBQUQ7QUFBQTtBQUNRO0FBQUMsaUNBQUQ7QUFBQSwwQkFBVyxPQUFNLGtCQUFqQjtBQUNJLGlEQUFDLGVBQUQsSUFBaUIsVUFBV0MsUUFBNUIsRUFBdUMsU0FBVUUsT0FBakQsRUFBMkQsVUFBV0gsTUFBTUksUUFBNUU7QUFESjtBQURSO0FBRkosYUFESjtBQVVILFNBaEJELE1BZ0JPO0FBQ0gsbUJBQU9PLFFBQVA7QUFDSDtBQUNKLEtBckJEO0FBc0JILENBdkI4QixFQXVCNUIsc0JBdkI0QixDQUEvQjs7QUF5QkE5RSxHQUFHbUYsS0FBSCxDQUFTQyxTQUFULENBQW9CLGtCQUFwQixFQUF3QyxrQ0FBeEMsRUFBNEVSLHFCQUE1RSIsImZpbGUiOiIwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBJcmFtZWx5IG9lbWJlZCBzY3JpcHRzXG4gKi9cbmNvbnN0IHsgX18gfSA9IHdwLmkxOG47XG5jb25zdCB7IGNyZWF0ZUhpZ2hlck9yZGVyQ29tcG9uZW50IH0gPSB3cC5jb21wb3NlO1xuY29uc3QgeyBGcmFnbWVudCB9ID0gd3AuZWxlbWVudDtcbmNvbnN0IHsgSW5zcGVjdG9yQ29udHJvbHMgfSA9IHdwLmJsb2NrRWRpdG9yO1xuY29uc3QgaUV2ZW50ID0gbmV3IFJlZ0V4cChcInNldElmcmFtZWx5RW1iZWRPcHRpb25zXCIpO1xuY29uc3QgeyBQYW5lbEJvZHkgfSA9IHdwLmNvbXBvbmVudHM7XG5cbmZ1bmN0aW9uIGZpbmRJZnJhbWVCeUNvbnRlbnRXaW5kb3coaWZyYW1lcywgY29udGVudFdpbmRvdykge1xuICAgIGxldCBmb3VuZElmcmFtZTtcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgaWZyYW1lcy5sZW5ndGggJiYgIWZvdW5kSWZyYW1lOyBpKyspIHtcbiAgICAgICAgbGV0IGlmcmFtZSA9IGlmcmFtZXNbaV07XG4gICAgICAgIGlmIChpZnJhbWUuY29udGVudFdpbmRvdyA9PT0gY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgZm91bmRJZnJhbWUgPSBpZnJhbWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZvdW5kSWZyYW1lO1xufVxuXG5mdW5jdGlvbiBzb3J0T2JqZWN0KG9iail7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikuc29ydCgpLnJlZHVjZSgoYWNjLGtleSk9PntcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkob2JqW2tleV0pKXtcbiAgICAgICAgICAgIGFjY1trZXldPW9ialtrZXldLm1hcChzb3J0T2JqZWN0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG9ialtrZXldID09PSAnb2JqZWN0Jyl7XG4gICAgICAgICAgICBhY2Nba2V5XT1zb3J0T2JqZWN0KG9ialtrZXldKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgYWNjW2tleV09b2JqW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICB9LHt9KTtcbn1cblxuZnVuY3Rpb24gZ2V0U2VsZWN0ZWRCbG9ja0lEKCkge1xuICAgIHJldHVybiB3cC5kYXRhLnNlbGVjdCggJ2NvcmUvZWRpdG9yJyApLmdldEJsb2NrU2VsZWN0aW9uU3RhcnQoKTtcbn1cblxuZnVuY3Rpb24gYWRkSWZyYW1lbHlTdHJpbmcodXJsLCBxdWVyeSkge1xuICAgIHZhciBuZXdVcmwgPSB1cmwucmVwbGFjZSgvXFw/PyY/aWZyYW1lbHk9KC4rKSQvLCAnJyk7XG4gICAgbmV3VXJsICs9IE9iamVjdC5rZXlzKHF1ZXJ5KS5sZW5ndGggPT09IDAgPyAnJyA6ICgoL1xcPy8udGVzdChuZXdVcmwpID8gJyYnOiAnPycpICsgJ2lmcmFtZWx5PScgKyB3aW5kb3cuYnRvYShKU09OLnN0cmluZ2lmeShxdWVyeSkpKTtcblxuICAgIHJldHVybiBuZXdVcmw7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVByZXZpZXcocXVlcnkpIHtcbiAgICAvLyBibG9jayBvcHRpb25zIGludGVyYWN0aW9uXG4gICAgbGV0IGJsb2NrQXR0cnMgPSB3cC5kYXRhLnNlbGVjdCgnY29yZS9ibG9jay1lZGl0b3InKS5nZXRCbG9ja0F0dHJpYnV0ZXMoZ2V0U2VsZWN0ZWRCbG9ja0lEKCkpLFxuICAgICAgICB1cmwgPSBibG9ja0F0dHJzLnVybDtcblxuICAgIGxldCBuZXdVcmwgPSBhZGRJZnJhbWVseVN0cmluZyh1cmwsIHNvcnRPYmplY3QocXVlcnkpKTtcblxuICAgIC8vIGJ1c3QgdGhlIGNhY2hlIHByZXZpZXcsIHNvIGl0IHJlLXJlbmRlcnMgd2hlbiByZXR1cm5pbmcgdG8gcHJldmlvdXMgb3B0aW9uc1xuICAgIC8vIGFsc28gd2FybXMgdXAgY2FjaGUgaWYgVVJMIGlzIG5ldywgYXMgdGhlIG5leHQgdGltZSBnZXRFbWJlZFByZXZpZXcgd2lsbCByZXR1cm4gY2FjaGVkIHZhbHVlXG4gICAgaWYgKHdwLmRhdGEuc2VsZWN0KCAnY29yZScgKS5nZXRFbWJlZFByZXZpZXcobmV3VXJsKSkge1xuICAgICAgICB3cC5kYXRhLmRpc3BhdGNoKCdjb3JlL2RhdGEnKS5pbnZhbGlkYXRlUmVzb2x1dGlvbiggJ2NvcmUnLCAnZ2V0RW1iZWRQcmV2aWV3JywgWyBuZXdVcmwgXSApO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB0aGUgY29ycmVzcG9uZGluZyBibG9jayBhbmQgZ2V0IGEgcHJldmlldyBpZiByZXF1aXJlZFxuICAgIHdwLmRhdGEuZGlzcGF0Y2goJ2NvcmUvYmxvY2stZWRpdG9yJykudXBkYXRlQmxvY2tBdHRyaWJ1dGVzKGdldFNlbGVjdGVkQmxvY2tJRCgpLCB7IHVybDogbmV3VXJsIH0pO1xuICAgIGNvbnNvbGUubG9nKFwiQ2hhbmdlZCBVUkw6IFwiLCBuZXdVcmwpO1xufVxuXG5pZiAoaWZyYW1lbHkpIHtcbiAgICAvLyBGYWlsc2FmZSBpbiBjYXNlIG9mIGlmcmFtZWx5IG5hbWUgc3BhY2Ugbm90IGFjY2Vzc2libGUuXG4gICAgLy8gRS5nLiBubyBpbnRlcm5ldCBjb25uZWN0aW9uXG4gICAgaWZyYW1lbHkub24oJ29wdGlvbnMtY2hhbmdlZCcsIGZ1bmN0aW9uKGlkLCBmb3JtQ29udGFpbmVyLCBxdWVyeSkge1xuICAgICAgICB1cGRhdGVQcmV2aWV3KHF1ZXJ5KTtcbiAgICB9KTtcbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsZnVuY3Rpb24oZSl7XG4gICAgLy8gTGlzdGVuIGZvciBtZXNzYWdlcyBmcm9tIGlmcmFtZSBwcm94eSBzY3JpcHRcbiAgICBpZihpRXZlbnQudGVzdChlLmRhdGEpKSB7XG4gICAgICAgIGxldCBmcmFtZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlmcmFtZVwiKSxcbiAgICAgICAgICAgIGlmcmFtZSA9IGZpbmRJZnJhbWVCeUNvbnRlbnRXaW5kb3coZnJhbWVzLCBlLnNvdXJjZSk7XG4gICAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShlLmRhdGEpO1xuICAgICAgICAkKGlmcmFtZSkuZGF0YShkYXRhKTtcbiAgICB9XG59LGZhbHNlKTtcblxuXG5jbGFzcyBJZnJhbWVseU9wdGlvbnMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGlmcmFtZWx5LmJ1aWxkT3B0aW9uc0Zvcm0odGhpcy5wcm9wcy5zZWxlY3RvciwgJCgnZGl2I2lmb3B0cycpLmdldCgwKSwgdGhpcy5wcm9wcy5vcHRpb25zLmRhdGEpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIDxkaXYgaWQ9XCJpZm9wdHNcIlxuICAgICAgICAgICAgICAgICAgICBkYXRhLWlkPXsgdGhpcy5wcm9wcy5jbGllbnRJZCB9XG4gICAgICAgICAgICAgICAgICAgIGRhdGEtb3B0cz17SlNPTi5zdHJpbmdpZnkodGhpcy5wcm9wcy5vcHRpb25zLmRhdGEpfVxuICAgICAgICA+eyB0aGlzLmJvZHkgfTwvZGl2PjtcbiAgICB9XG59XG5cbklmcmFtZWx5T3B0aW9ucy5kZWZhdWx0UHJvcHMgPSB7XG4gICAgYm9keTogJycsXG4gICAgY2xpZW50SWQ6ICcnLFxuICAgIHNlbGVjdG9yOiAnJyxcbiAgICBvcHRpb25zOiAnJyxcbn07XG5jb25zdCB3aXRoSW5zcGVjdG9yQ29udHJvbHMgPSAgY3JlYXRlSGlnaGVyT3JkZXJDb21wb25lbnQoICggQmxvY2tFZGl0ICkgPT4ge1xuICAgIHJldHVybiAoIHByb3BzICkgPT4ge1xuICAgICAgICBsZXQgZnJhZ21lbnQgPSAoPEZyYWdtZW50PjxCbG9ja0VkaXQgeyAuLi5wcm9wcyB9IC8+PC9GcmFnbWVudD4pO1xuICAgICAgICBpZiAocHJvcHMuaXNTZWxlY3RlZD09PXRydWUgJiYgKHByb3BzLm5hbWUgPT09IFwiY29yZS9lbWJlZFwiIHx8IHByb3BzLm5hbWUuc3RhcnRzV2l0aChcImNvcmUtZW1iZWRcIikpKSB7XG4gICAgICAgICAgICBsZXQgc2VsZWN0b3IgPSAnZGl2I2Jsb2NrLScgKyBwcm9wcy5jbGllbnRJZDtcbiAgICAgICAgICAgIGxldCBvcHRpb25zID0gJChzZWxlY3RvcikuZmluZCgnaWZyYW1lJykuZGF0YSgpO1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zIHx8ICFvcHRpb25zLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnJhZ21lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxGcmFnbWVudD5cbiAgICAgICAgICAgICAgICAgICAgPEJsb2NrRWRpdCB7IC4uLnByb3BzIH0gLz5cbiAgICAgICAgICAgICAgICAgICAgPEluc3BlY3RvckNvbnRyb2xzPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxQYW5lbEJvZHkgdGl0bGU9XCJJZnJhbWVseSBvcHRpb25zXCIgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWZyYW1lbHlPcHRpb25zIHNlbGVjdG9yPXsgc2VsZWN0b3IgfSBvcHRpb25zPXsgb3B0aW9ucyB9IGNsaWVudElkPXsgcHJvcHMuY2xpZW50SWQgfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUGFuZWxCb2R5PlxuICAgICAgICAgICAgICAgICAgICA8L0luc3BlY3RvckNvbnRyb2xzPlxuICAgICAgICAgICAgICAgIDwvRnJhZ21lbnQ+XG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZyYWdtZW50O1xuICAgICAgICB9XG4gICAgfTtcbn0sIFwid2l0aEluc3BlY3RvckNvbnRyb2xcIiApO1xuXG53cC5ob29rcy5hZGRGaWx0ZXIoICdlZGl0b3IuQmxvY2tFZGl0JywgJ2lmcmFtZWx5L3dpdGgtaW5zcGVjdG9yLWNvbnRyb2xzJywgd2l0aEluc3BlY3RvckNvbnRyb2xzICk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LmpzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

/***/ })
/******/ ]);