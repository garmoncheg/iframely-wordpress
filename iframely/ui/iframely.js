/******/ (function(modules) { // webpackBootstrap
    /******/ 	// The module cache
    /******/ 	var installedModules = {};
    /******/
    /******/ 	// The require function
    /******/ 	function __webpack_require__(moduleId) {
        /******/
        /******/ 		// Check if module is in cache
        /******/ 		if(installedModules[moduleId]) {
            /******/ 			return installedModules[moduleId].exports;
            /******/ 		}
        /******/ 		// Create a new module (and put it into the cache)
        /******/ 		var module = installedModules[moduleId] = {
            /******/ 			i: moduleId,
            /******/ 			l: false,
            /******/ 			exports: {}
            /******/ 		};
        /******/
        /******/ 		// Execute the module function
        /******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
        /******/
        /******/ 		// Flag the module as loaded
        /******/ 		module.l = true;
        /******/
        /******/ 		// Return the exports of the module
        /******/ 		return module.exports;
        /******/ 	}
    /******/
    /******/
    /******/ 	// expose the modules object (__webpack_modules__)
    /******/ 	__webpack_require__.m = modules;
    /******/
    /******/ 	// expose the module cache
    /******/ 	__webpack_require__.c = installedModules;
    /******/
    /******/ 	// define getter function for harmony exports
    /******/ 	__webpack_require__.d = function(exports, name, getter) {
        /******/ 		if(!__webpack_require__.o(exports, name)) {
            /******/ 			Object.defineProperty(exports, name, {
                /******/ 				configurable: false,
                /******/ 				enumerable: true,
                /******/ 				get: getter
                /******/ 			});
            /******/ 		}
        /******/ 	};
    /******/
    /******/ 	// getDefaultExport function for compatibility with non-harmony modules
    /******/ 	__webpack_require__.n = function(module) {
        /******/ 		var getter = module && module.__esModule ?
            /******/ 			function getDefault() { return module['default']; } :
            /******/ 			function getModuleExports() { return module; };
        /******/ 		__webpack_require__.d(getter, 'a', getter);
        /******/ 		return getter;
        /******/ 	};
    /******/
    /******/ 	// Object.prototype.hasOwnProperty.call
    /******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
    /******/
    /******/ 	// __webpack_public_path__
    /******/ 	__webpack_require__.p = "";
    /******/
    /******/ 	// Load entry module and return exports
    /******/ 	return __webpack_require__(__webpack_require__.s = 0);
    /******/ })
/************************************************************************/
/******/ ([
    /* 0 */
    /***/ (function(module, exports) {

        eval("var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/**\n * Iramely oembed scripts\n */\nvar __ = wp.i18n.__;\nvar createHigherOrderComponent = wp.compose.createHigherOrderComponent;\nvar Fragment = wp.element.Fragment;\nvar InspectorControls = wp.blockEditor.InspectorControls;\n\nvar iEvent = new RegExp(\"setIframelyEmbedOptions\");\nvar PanelBody = wp.components.PanelBody;\n\n\nfunction findIframeByContentWindow(iframes, contentWindow) {\n    var foundIframe = void 0;\n    for (var i = 0; i < iframes.length && !foundIframe; i++) {\n        var iframe = iframes[i];\n        if (iframe.contentWindow === contentWindow) {\n            foundIframe = iframe;\n        }\n    }\n    return foundIframe;\n}\n\nfunction sortObject(obj) {\n    return Object.keys(obj).sort().reduce(function (acc, key) {\n        if (Array.isArray(obj[key])) {\n            acc[key] = obj[key].map(sortObjectKeys);\n        }\n        if (_typeof(obj[key]) === 'object') {\n            acc[key] = sortObjectKeys(obj[key]);\n        } else {\n            acc[key] = obj[key];\n        }\n        return acc;\n    }, {});\n}\n\nfunction updateIframe(id, query) {\n    // block options interaction\n    var clientId = id.split(\"div#block-\")[1],\n        blockAttrs = wp.data.select('core/block-editor').getBlockAttributes(clientId),\n        url = blockAttrs.url,\n        iframely_key = '&iframely=';\n\n    // Parse url and make sure we are replacing an url query string properly\n    if (url.indexOf('iframely=') > 0) {\n        var durl = url.split('iframely=')[0];\n        url = durl.substr(0, durl.length - 1);\n    }\n    if (url.indexOf('?') === -1) {\n        iframely_key = '?iframely=';\n    }\n\n    // Ensure sorted options object to make sure\n    // we generating same data each time for same options.\n    query = sortObject(query);\n    //query.timestamp = new Date();\n\n    // Join the url string with iframely params\n    var params = iframely_key + encodeURIComponent(window.btoa(JSON.stringify(query)));\n    var newUrl = url + params;\n\n    // Update the corresponding block and get a preview if required\n    var promise = wp.data.dispatch('core/block-editor').updateBlockAttributes([clientId], { url: newUrl });\n    promise.then(function (value) {\n        var id = value.clientId[0];\n        console.log(id);\n        $('div[data-block=' + id + '] iframe').on('load', function () {\n            console.log(\"Loaded Iframe\", this);\n        });\n        $($('div#ifopts').get(0)).attr('data-id', id);\n    });\n}\n\nif (iframely) {\n    // Failsafe in case of iframely name space not accessible.\n    // E.g. no internet connection\n    iframely.on('options-changed', function (id, formContainer, query) {\n        updateIframe(id, query);\n    });\n}\n\nfunction initListener() {\n    window.addEventListener(\"message\", function (e) {\n        if (iEvent.test(e.data)) {\n            var frames = document.getElementsByTagName(\"iframe\"),\n                iframe = findIframeByContentWindow(frames, e.source);\n            var data = JSON.parse(e.data);\n            $(iframe).data(data);\n            if ($('div#ifopts').get(0)) {\n                console.log('form exists');\n                var id = $('div#ifopts').attr('data-id');\n                iframely.buildOptionsForm(id, $('div#ifopts').get(0), data);\n            }\n        }\n    }, false);\n}\ninitListener();\n\nvar IframelyOptions = function (_React$Component) {\n    _inherits(IframelyOptions, _React$Component);\n\n    function IframelyOptions() {\n        _classCallCheck(this, IframelyOptions);\n\n        return _possibleConstructorReturn(this, (IframelyOptions.__proto__ || Object.getPrototypeOf(IframelyOptions)).apply(this, arguments));\n    }\n\n    _createClass(IframelyOptions, [{\n        key: \"componentDidMount\",\n        value: function componentDidMount() {\n            iframely.buildOptionsForm(this.props.selector, $('div#ifopts').get(0), this.props.options.data);\n        }\n    }, {\n        key: \"render\",\n        value: function render() {\n            return wp.element.createElement(\n                \"div\",\n                { id: \"ifopts\",\n                    \"data-id\": this.props.clientId,\n                    \"data-opts\": JSON.stringify(this.props.options.data)\n                },\n                this.body\n            );\n        }\n    }]);\n\n    return IframelyOptions;\n}(React.Component);\n\nIframelyOptions.defaultProps = {\n    body: '',\n    clientId: '',\n    selector: '',\n    options: ''\n};\nvar withInspectorControls = createHigherOrderComponent(function (BlockEdit) {\n    return function (props) {\n        var fragment = wp.element.createElement(\n            Fragment,\n            null,\n            wp.element.createElement(BlockEdit, props)\n        );\n        if (props.isSelected === true && (props.name === \"core/embed\" || props.name.startsWith(\"core-embed\"))) {\n            var selector = 'div#block-' + props.clientId;\n            var options = $(selector).find('iframe').data();\n            if (!options || !options.data) {\n                return fragment;\n            }\n            return wp.element.createElement(\n                Fragment,\n                null,\n                wp.element.createElement(BlockEdit, props),\n                wp.element.createElement(\n                    InspectorControls,\n                    null,\n                    wp.element.createElement(\n                        PanelBody,\n                        { title: \"Iframely options\" },\n                        wp.element.createElement(IframelyOptions, { selector: selector, options: options, clientId: props.clientId })\n                    )\n                )\n            );\n        } else {\n            return fragment;\n        }\n    };\n}, \"withInspectorControl\");\n\nwp.hooks.addFilter('editor.BlockEdit', 'iframely/with-inspector-controls', withInspectorControls);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanM/OTU1MiJdLCJuYW1lcyI6WyJfXyIsIndwIiwiaTE4biIsImNyZWF0ZUhpZ2hlck9yZGVyQ29tcG9uZW50IiwiY29tcG9zZSIsIkZyYWdtZW50IiwiZWxlbWVudCIsIkluc3BlY3RvckNvbnRyb2xzIiwiYmxvY2tFZGl0b3IiLCJpRXZlbnQiLCJSZWdFeHAiLCJQYW5lbEJvZHkiLCJjb21wb25lbnRzIiwiZmluZElmcmFtZUJ5Q29udGVudFdpbmRvdyIsImlmcmFtZXMiLCJjb250ZW50V2luZG93IiwiZm91bmRJZnJhbWUiLCJpIiwibGVuZ3RoIiwiaWZyYW1lIiwic29ydE9iamVjdCIsIm9iaiIsIk9iamVjdCIsImtleXMiLCJzb3J0IiwicmVkdWNlIiwiYWNjIiwia2V5IiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwic29ydE9iamVjdEtleXMiLCJ1cGRhdGVJZnJhbWUiLCJpZCIsInF1ZXJ5IiwiY2xpZW50SWQiLCJzcGxpdCIsImJsb2NrQXR0cnMiLCJkYXRhIiwic2VsZWN0IiwiZ2V0QmxvY2tBdHRyaWJ1dGVzIiwidXJsIiwiaWZyYW1lbHlfa2V5IiwiaW5kZXhPZiIsImR1cmwiLCJzdWJzdHIiLCJwYXJhbXMiLCJlbmNvZGVVUklDb21wb25lbnQiLCJ3aW5kb3ciLCJidG9hIiwiSlNPTiIsInN0cmluZ2lmeSIsIm5ld1VybCIsInByb21pc2UiLCJkaXNwYXRjaCIsInVwZGF0ZUJsb2NrQXR0cmlidXRlcyIsInRoZW4iLCJ2YWx1ZSIsImNvbnNvbGUiLCJsb2ciLCIkIiwib24iLCJnZXQiLCJhdHRyIiwiaWZyYW1lbHkiLCJmb3JtQ29udGFpbmVyIiwiaW5pdExpc3RlbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJ0ZXN0IiwiZnJhbWVzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInNvdXJjZSIsInBhcnNlIiwiYnVpbGRPcHRpb25zRm9ybSIsIklmcmFtZWx5T3B0aW9ucyIsInByb3BzIiwic2VsZWN0b3IiLCJvcHRpb25zIiwiYm9keSIsIlJlYWN0IiwiQ29tcG9uZW50IiwiZGVmYXVsdFByb3BzIiwid2l0aEluc3BlY3RvckNvbnRyb2xzIiwiQmxvY2tFZGl0IiwiZnJhZ21lbnQiLCJpc1NlbGVjdGVkIiwibmFtZSIsInN0YXJ0c1dpdGgiLCJmaW5kIiwiaG9va3MiLCJhZGRGaWx0ZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTs7O0lBR1FBLEUsR0FBT0MsR0FBR0MsSSxDQUFWRixFO0lBQ0FHLDBCLEdBQStCRixHQUFHRyxPLENBQWxDRCwwQjtJQUNBRSxRLEdBQWFKLEdBQUdLLE8sQ0FBaEJELFE7SUFDQUUsaUIsR0FBc0JOLEdBQUdPLFcsQ0FBekJELGlCOztBQUNSLElBQU1FLFNBQVMsSUFBSUMsTUFBSixDQUFXLHlCQUFYLENBQWY7SUFDUUMsUyxHQUFjVixHQUFHVyxVLENBQWpCRCxTOzs7QUFFUixTQUFTRSx5QkFBVCxDQUFtQ0MsT0FBbkMsRUFBNENDLGFBQTVDLEVBQTJEO0FBQ3ZELFFBQUlDLG9CQUFKO0FBQ0EsU0FBSSxJQUFJQyxJQUFJLENBQVosRUFBZUEsSUFBSUgsUUFBUUksTUFBWixJQUFzQixDQUFDRixXQUF0QyxFQUFtREMsR0FBbkQsRUFBd0Q7QUFDcEQsWUFBSUUsU0FBU0wsUUFBUUcsQ0FBUixDQUFiO0FBQ0EsWUFBSUUsT0FBT0osYUFBUCxLQUF5QkEsYUFBN0IsRUFBNEM7QUFDeENDLDBCQUFjRyxNQUFkO0FBQ0g7QUFDSjtBQUNELFdBQU9ILFdBQVA7QUFDSDs7QUFFRCxTQUFTSSxVQUFULENBQW9CQyxHQUFwQixFQUF3QjtBQUNwQixXQUFPQyxPQUFPQyxJQUFQLENBQVlGLEdBQVosRUFBaUJHLElBQWpCLEdBQXdCQyxNQUF4QixDQUErQixVQUFDQyxHQUFELEVBQUtDLEdBQUwsRUFBVztBQUM3QyxZQUFJQyxNQUFNQyxPQUFOLENBQWNSLElBQUlNLEdBQUosQ0FBZCxDQUFKLEVBQTRCO0FBQ3hCRCxnQkFBSUMsR0FBSixJQUFT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RWtGLFNBQUYsRUFBaUI7QUFDeEUsV0FBTyxVQUFFUixLQUFGLEVBQWE7QUFDaEIsWUFBSVMsV0FBWTtBQUFDLG9CQUFEO0FBQUE7QUFBVSxxQ0FBQyxTQUFELEVBQWdCVCxLQUFoQjtBQUFWLFNBQWhCO0FBQ0EsWUFBSUEsTUFBTVUsVUFBTixLQUFtQixJQUFuQixLQUE0QlYsTUFBTVcsSUFBTixLQUFlLFlBQWYsSUFBK0JYLE1BQU1XLElBQU4sQ0FBV0MsVUFBWCxDQUFzQixZQUF0QixDQUEzRCxDQUFKLEVBQXFHO0FBQ2pHLGdCQUFJWCxXQUFXLGVBQWVELE1BQU0xQyxRQUFwQztBQUNBLGdCQUFJNEMsVUFBVW5CLEVBQUVrQixRQUFGLEVBQVlZLElBQVosQ0FBaUIsUUFBakIsRUFBMkJwRCxJQUEzQixFQUFkO0FBQ0EsZ0JBQUksQ0FBQ3lDLE9BQUQsSUFBWSxDQUFDQSxRQUFRekMsSUFBekIsRUFBK0I7QUFDM0IsdUJBQU9nRCxRQUFQO0FBQ0g7QUFDRCxtQkFDSTtBQUFDLHdCQUFEO0FBQUE7QUFDSSx5Q0FBQyxTQUFELEVBQWdCVCxLQUFoQixDQURKO0FBRUk7QUFBQyxxQ0FBRDtBQUFBO0FBQ1E7QUFBQyxpQ0FBRDtBQUFBLDBCQUFXLE9BQU0sa0JBQWpCO0FBQ0ksaURBQUMsZUFBRCxJQUFpQixVQUFXQyxRQUE1QixFQUF1QyxTQUFVQyxPQUFqRCxFQUEyRCxVQUFXRixNQUFNMUMsUUFBNUU7QUFESjtBQURSO0FBRkosYUFESjtBQVVILFNBaEJELE1BZ0JPO0FBQ0gsbUJBQU9tRCxRQUFQO0FBQ0g7QUFDSixLQXJCRDtBQXNCSCxDQXZCOEIsRUF1QjVCLHNCQXZCNEIsQ0FBL0I7O0FBeUJBckYsR0FBRzBGLEtBQUgsQ0FBU0MsU0FBVCxDQUFvQixrQkFBcEIsRUFBd0Msa0NBQXhDLEVBQTRFUixxQkFBNUUiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSXJhbWVseSBvZW1iZWQgc2NyaXB0c1xuICovXG5jb25zdCB7IF9fIH0gPSB3cC5pMThuO1xuY29uc3QgeyBjcmVhdGVIaWdoZXJPcmRlckNvbXBvbmVudCB9ID0gd3AuY29tcG9zZTtcbmNvbnN0IHsgRnJhZ21lbnQgfSA9IHdwLmVsZW1lbnQ7XG5jb25zdCB7IEluc3BlY3RvckNvbnRyb2xzIH0gPSB3cC5ibG9ja0VkaXRvcjtcbmNvbnN0IGlFdmVudCA9IG5ldyBSZWdFeHAoXCJzZXRJZnJhbWVseUVtYmVkT3B0aW9uc1wiKTtcbmNvbnN0IHsgUGFuZWxCb2R5IH0gPSB3cC5jb21wb25lbnRzO1xuXG5mdW5jdGlvbiBmaW5kSWZyYW1lQnlDb250ZW50V2luZG93KGlmcmFtZXMsIGNvbnRlbnRXaW5kb3cpIHtcbiAgICBsZXQgZm91bmRJZnJhbWU7XG4gICAgZm9yKGxldCBpID0gMDsgaSA8IGlmcmFtZXMubGVuZ3RoICYmICFmb3VuZElmcmFtZTsgaSsrKSB7XG4gICAgICAgIGxldCBpZnJhbWUgPSBpZnJhbWVzW2ldO1xuICAgICAgICBpZiAoaWZyYW1lLmNvbnRlbnRXaW5kb3cgPT09IGNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICAgIGZvdW5kSWZyYW1lID0gaWZyYW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmb3VuZElmcmFtZTtcbn1cblxuZnVuY3Rpb24gc29ydE9iamVjdChvYmope1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhvYmopLnNvcnQoKS5yZWR1Y2UoKGFjYyxrZXkpPT57XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KG9ialtrZXldKSl7XG4gICAgICAgICAgICBhY2Nba2V5XT1vYmpba2V5XS5tYXAoc29ydE9iamVjdEtleXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygb2JqW2tleV0gPT09ICdvYmplY3QnKXtcbiAgICAgICAgICAgIGFjY1trZXldPXNvcnRPYmplY3RLZXlzKG9ialtrZXldKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgYWNjW2tleV09b2JqW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICB9LHt9KTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlSWZyYW1lKGlkLCBxdWVyeSkge1xuICAgIC8vIGJsb2NrIG9wdGlvbnMgaW50ZXJhY3Rpb25cbiAgICBsZXQgY2xpZW50SWQgPSBpZC5zcGxpdChcImRpdiNibG9jay1cIilbMV0sXG4gICAgICAgIGJsb2NrQXR0cnMgPSB3cC5kYXRhLnNlbGVjdCgnY29yZS9ibG9jay1lZGl0b3InKS5nZXRCbG9ja0F0dHJpYnV0ZXMoY2xpZW50SWQpLFxuICAgICAgICB1cmwgPSBibG9ja0F0dHJzLnVybCxcbiAgICAgICAgaWZyYW1lbHlfa2V5ID0gJyZpZnJhbWVseT0nO1xuXG4gICAgLy8gUGFyc2UgdXJsIGFuZCBtYWtlIHN1cmUgd2UgYXJlIHJlcGxhY2luZyBhbiB1cmwgcXVlcnkgc3RyaW5nIHByb3Blcmx5XG4gICAgaWYodXJsLmluZGV4T2YoJ2lmcmFtZWx5PScpID4gMCkge1xuICAgICAgICBsZXQgZHVybCA9IHVybC5zcGxpdCgnaWZyYW1lbHk9JylbMF07XG4gICAgICAgIHVybCA9IGR1cmwuc3Vic3RyKDAsIGR1cmwubGVuZ3RoLTEpO1xuICAgIH1cbiAgICBpZih1cmwuaW5kZXhPZignPycpID09PSAtMSkge1xuICAgICAgICBpZnJhbWVseV9rZXkgPSAnP2lmcmFtZWx5PSc7XG4gICAgfVxuXG4gICAgLy8gRW5zdXJlIHNvcnRlZCBvcHRpb25zIG9iamVjdCB0byBtYWtlIHN1cmVcbiAgICAvLyB3ZSBnZW5lcmF0aW5nIHNhbWUgZGF0YSBlYWNoIHRpbWUgZm9yIHNhbWUgb3B0aW9ucy5cbiAgICBxdWVyeSA9IHNvcnRPYmplY3QocXVlcnkpO1xuICAgIC8vcXVlcnkudGltZXN0YW1wID0gbmV3IERhdGUoKTtcblxuICAgIC8vIEpvaW4gdGhlIHVybCBzdHJpbmcgd2l0aCBpZnJhbWVseSBwYXJhbXNcbiAgICBsZXQgcGFyYW1zID0gaWZyYW1lbHlfa2V5ICsgZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5idG9hKEpTT04uc3RyaW5naWZ5KHF1ZXJ5KSkpO1xuICAgIGxldCBuZXdVcmwgPSB1cmwgKyBwYXJhbXM7XG5cbiAgICAvLyBVcGRhdGUgdGhlIGNvcnJlc3BvbmRpbmcgYmxvY2sgYW5kIGdldCBhIHByZXZpZXcgaWYgcmVxdWlyZWRcbiAgICBsZXQgcHJvbWlzZSA9IHdwLmRhdGEuZGlzcGF0Y2goJ2NvcmUvYmxvY2stZWRpdG9yJykudXBkYXRlQmxvY2tBdHRyaWJ1dGVzKFtjbGllbnRJZF0sIHsgdXJsOiBuZXdVcmwgfSk7XG4gICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGxldCBpZCA9IHZhbHVlLmNsaWVudElkWzBdO1xuICAgICAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgICAgICQoJ2RpdltkYXRhLWJsb2NrPScrIGlkKyAnXSBpZnJhbWUnKS5vbignbG9hZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2FkZWQgSWZyYW1lXCIsIHRoaXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgJCgkKCdkaXYjaWZvcHRzJykuZ2V0KDApKS5hdHRyKCdkYXRhLWlkJywgaWQpO1xuXG4gICAgfSk7XG5cbn1cblxuaWYgKGlmcmFtZWx5KSB7XG4gICAgLy8gRmFpbHNhZmUgaW4gY2FzZSBvZiBpZnJhbWVseSBuYW1lIHNwYWNlIG5vdCBhY2Nlc3NpYmxlLlxuICAgIC8vIEUuZy4gbm8gaW50ZXJuZXQgY29ubmVjdGlvblxuICAgIGlmcmFtZWx5Lm9uKCdvcHRpb25zLWNoYW5nZWQnLCBmdW5jdGlvbihpZCwgZm9ybUNvbnRhaW5lciwgcXVlcnkpIHtcbiAgICAgICAgdXBkYXRlSWZyYW1lKGlkLCBxdWVyeSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGluaXRMaXN0ZW5lcigpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIixmdW5jdGlvbihlKXtcbiAgICAgICAgaWYoaUV2ZW50LnRlc3QoZS5kYXRhKSkge1xuICAgICAgICAgICAgbGV0IGZyYW1lcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaWZyYW1lXCIpLFxuICAgICAgICAgICAgICAgIGlmcmFtZSA9IGZpbmRJZnJhbWVCeUNvbnRlbnRXaW5kb3coZnJhbWVzLCBlLnNvdXJjZSk7XG4gICAgICAgICAgICBsZXQgZGF0YSA9IEpTT04ucGFyc2UoZS5kYXRhKVxuICAgICAgICAgICAgJChpZnJhbWUpLmRhdGEoZGF0YSk7XG4gICAgICAgICAgICBpZiAoJCgnZGl2I2lmb3B0cycpLmdldCgwKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmb3JtIGV4aXN0cycpO1xuICAgICAgICAgICAgICAgIGxldCBpZCA9ICQoJ2RpdiNpZm9wdHMnKS5hdHRyKCdkYXRhLWlkJyk7XG4gICAgICAgICAgICAgICAgaWZyYW1lbHkuYnVpbGRPcHRpb25zRm9ybShpZCwgJCgnZGl2I2lmb3B0cycpLmdldCgwKSwgZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LGZhbHNlKTtcbn1cbmluaXRMaXN0ZW5lcigpO1xuXG5jbGFzcyBJZnJhbWVseU9wdGlvbnMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGlmcmFtZWx5LmJ1aWxkT3B0aW9uc0Zvcm0odGhpcy5wcm9wcy5zZWxlY3RvciwgJCgnZGl2I2lmb3B0cycpLmdldCgwKSwgdGhpcy5wcm9wcy5vcHRpb25zLmRhdGEpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIDxkaXYgaWQ9XCJpZm9wdHNcIlxuICAgICAgICAgICAgICAgICAgICBkYXRhLWlkPXsgdGhpcy5wcm9wcy5jbGllbnRJZCB9XG4gICAgICAgICAgICAgICAgICAgIGRhdGEtb3B0cz17SlNPTi5zdHJpbmdpZnkodGhpcy5wcm9wcy5vcHRpb25zLmRhdGEpfVxuICAgICAgICA+eyB0aGlzLmJvZHkgfTwvZGl2PjtcbiAgICB9XG59XG5cbklmcmFtZWx5T3B0aW9ucy5kZWZhdWx0UHJvcHMgPSB7XG4gICAgYm9keTogJycsXG4gICAgY2xpZW50SWQ6ICcnLFxuICAgIHNlbGVjdG9yOiAnJyxcbiAgICBvcHRpb25zOiAnJyxcbn07XG5jb25zdCB3aXRoSW5zcGVjdG9yQ29udHJvbHMgPSAgY3JlYXRlSGlnaGVyT3JkZXJDb21wb25lbnQoICggQmxvY2tFZGl0ICkgPT4ge1xuICAgIHJldHVybiAoIHByb3BzICkgPT4ge1xuICAgICAgICBsZXQgZnJhZ21lbnQgPSAoPEZyYWdtZW50PjxCbG9ja0VkaXQgeyAuLi5wcm9wcyB9IC8+PC9GcmFnbWVudD4pO1xuICAgICAgICBpZiAocHJvcHMuaXNTZWxlY3RlZD09PXRydWUgJiYgKHByb3BzLm5hbWUgPT09IFwiY29yZS9lbWJlZFwiIHx8IHByb3BzLm5hbWUuc3RhcnRzV2l0aChcImNvcmUtZW1iZWRcIikpKSB7XG4gICAgICAgICAgICBsZXQgc2VsZWN0b3IgPSAnZGl2I2Jsb2NrLScgKyBwcm9wcy5jbGllbnRJZDtcbiAgICAgICAgICAgIGxldCBvcHRpb25zID0gJChzZWxlY3RvcikuZmluZCgnaWZyYW1lJykuZGF0YSgpO1xuICAgICAgICAgICAgaWYgKCFvcHRpb25zIHx8ICFvcHRpb25zLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnJhZ21lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxGcmFnbWVudD5cbiAgICAgICAgICAgICAgICAgICAgPEJsb2NrRWRpdCB7IC4uLnByb3BzIH0gLz5cbiAgICAgICAgICAgICAgICAgICAgPEluc3BlY3RvckNvbnRyb2xzPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxQYW5lbEJvZHkgdGl0bGU9XCJJZnJhbWVseSBvcHRpb25zXCIgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SWZyYW1lbHlPcHRpb25zIHNlbGVjdG9yPXsgc2VsZWN0b3IgfSBvcHRpb25zPXsgb3B0aW9ucyB9IGNsaWVudElkPXsgcHJvcHMuY2xpZW50SWQgfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvUGFuZWxCb2R5PlxuICAgICAgICAgICAgICAgICAgICA8L0luc3BlY3RvckNvbnRyb2xzPlxuICAgICAgICAgICAgICAgIDwvRnJhZ21lbnQ+XG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZyYWdtZW50O1xuICAgICAgICB9XG4gICAgfTtcbn0sIFwid2l0aEluc3BlY3RvckNvbnRyb2xcIiApO1xuXG53cC5ob29rcy5hZGRGaWx0ZXIoICdlZGl0b3IuQmxvY2tFZGl0JywgJ2lmcmFtZWx5L3dpdGgtaW5zcGVjdG9yLWNvbnRyb2xzJywgd2l0aEluc3BlY3RvckNvbnRyb2xzICk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LmpzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

        /***/ })
    /******/ ]);